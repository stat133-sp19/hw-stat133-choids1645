simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_manual(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib", value = c("")))
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib), size = 1) + geom_point(aes(y = no_contrib)) +
geom_line(aes(y = fixed_contrib), size = 1) + geom_point(aes(y = fixed_contrib)) +
geom_line(aes(y = growing_contrib), size = 1) + geom_point(aes(y = growing_contrib)) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "blue"), size = 1) + geom_point(aes(y = no_contrib, colour = "blue")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "red"), size = 1) + geom_point(aes(y = growing_contrib, colour = "red")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("growing_contrib", "fixed_contrib", "no_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib) colour = "red", size = 1) + geom_point(aes(y = no_contrib) colour = "red") +
geom_line(aes(y = fixed_contrib) colour = "green", size = 1) + geom_point(aes(y = fixed_contrib) colour = "green") +
geom_line(aes(y = growing_contrib) colour = "blue", size = 1) + geom_point(aes(y = growing_contrib) colour = "blue") +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib), colour = "red", size = 1) + geom_point(aes(y = no_contrib), colour = "red") +
geom_line(aes(y = fixed_contrib), colour = "green", size = 1) + geom_point(aes(y = fixed_contrib), colour = "green") +
geom_line(aes(y = growing_contrib), colour = "blue", size = 1) + geom_point(aes(y = growing_contrib), colour = "blue") +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = no_contrib), size = 1) + geom_point(aes(y = no_contrib, colour = no_contrib)) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
colnames(simulation)
colnames(simulation)[2:4]
#5.2
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib), size = 1) + geom_point(aes(y = no_contrib)) +
geom_line(aes(y = fixed_contrib), size = 1) + geom_point(aes(y = fixed_contrib)) +
geom_line(aes(y = growing_contrib), size = 1) + geom_point(aes(y = growing_contrib)) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = factor(colnames(simulation)[2:4])) +
geom_line(aes(y = no_contrib), size = 1) + geom_point(aes(y = no_contrib)) +
geom_line(aes(y = fixed_contrib), size = 1) + geom_point(aes(y = fixed_contrib)) +
geom_line(aes(y = growing_contrib), size = 1) + geom_point(aes(y = growing_contrib)) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type)
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) + labs(colour = "modality")
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) + labs(colour = "modality") + guides(colour = guide_legend(reverse = TRUE))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) + labs(colour = "modality") + guides(colour = guide_legend(reverse = TRUE))
#5.2
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = "red"), size = 1) + geom_point(aes(y = no_contrib, colour = "red")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = growing_contrib, colour = "blue")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) + labs(colour = "modality") + guides(colour = guide_legend(reverse = TRUE))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +  scale_color_discrete(name = "modality")
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +  scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +  scale_color_discrete(name = "modality")
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = growing_contrib, colour = colnames(simulation)[4]), size = 1) + geom_point(aes(y = growing_contrib, colour = colnames(simulation)[4])) +
geom_line(aes(y = no_contrib, colour = colnames(simulation)[2]), size = 1) + geom_point(aes(y = no_contrib, colour = colnames(simulation)[2])) +
geom_line(aes(y = fixed_contrib, colour = colnames(simulation)[3]), size = 1) + geom_point(aes(y = fixed_contrib, colour = colnames(simulation)[3])) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +  scale_color_discrete(name = "modality")
#5.2
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib, colour = "blue"), size = 1) + geom_point(aes(y = no_contrib, colour = "blue")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "red"), size = 1) + geom_point(aes(y = growing_contrib, colour = "red")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
simulation %>% ggplot() + aes(x = year, colour = colnames(simulation)[2:4]) +
geom_line(aes(y = no_contrib), size = 1) + geom_point(aes(y = no_contrib)) +
geom_line(aes(y = fixed_contrib), size = 1) + geom_point(aes(y = fixed_contrib)) +
geom_line(aes(y = growing_contrib), size = 1) + geom_point(aes(y = growing_contrib)) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#5.2
simulation %>% ggplot() + aes(x = year) +
geom_line(aes(y = no_contrib, colour = "blue"), size = 1) + geom_point(aes(y = no_contrib, colour = "blue")) +
geom_line(aes(y = fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = fixed_contrib, colour = "green")) +
geom_line(aes(y = growing_contrib, colour = "red"), size = 1) + geom_point(aes(y = growing_contrib, colour = "red")) +
xlab("year") + ylab("balance") + scale_x_continuous(breaks = seq(0, 15, 5)) + theme_bw() + facet_wrap(simulation$type) +
scale_color_discrete(name = "modality", labels = c("no_contrib", "fixed_contrib", "growing_contrib"))
#2
ggplot(data = modalities) + aes(x = modalities$year) + geom_line(aes(y = modalities$no_contrib, colour = "red"), size = 1) + geom_point(aes(y = modalities$no_contrib, colour = "red")) +
geom_line(aes(y = modalities$fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = modalities$fixed_contrib, colour = "green")) + geom_line(aes(y = modalities$growing_contrib, colour = "blue"), size = 1) + geom_point(aes(y = modalities$growing_contrib, colour = "blue")) + scale_colour_discrete(name = 'Modality', labels = c("growing_contrib", "fixed_contrib", "no_contrib")) + xlab("Year") + ylab("Investment in $") + ggtitle("Modality Graphs") + scale_x_continuous(breaks = seq(0, 10, 2)) + theme_bw()
#2
ggplot(data = modalities) + aes(x = modalities$year) + geom_line(aes(y = modalities$no_contrib, colour = "blue"), size = 1) + geom_point(aes(y = modalities$no_contrib, colour = "blue")) +
geom_line(aes(y = modalities$fixed_contrib, colour = "green"), size = 1) + geom_point(aes(y = modalities$fixed_contrib, colour = "green")) + geom_line(aes(y = modalities$growing_contrib, colour = "red"), size = 1) + geom_point(aes(y = modalities$growing_contrib, colour = "red")) + scale_colour_discrete(name = 'Modality', labels = c("no_contrib", "fixed_contrib", "growing_contrib")) + xlab("Year") + ylab("Investment in $") + ggtitle("Modality Graphs") + scale_x_continuous(breaks = seq(0, 10, 2)) + theme_bw()
knitr::opts_chunk$set(echo = TRUE)
total_unemployed <- sum(employment_marital[2,])
knitr::opts_chunk$set(echo = TRUE)
x_i <- c(1997, 906, 904, 32)
lik <- function(theta) {
sum <- dmultinom(x = x_i, size = sum(x_i), prob = c( (0.25*(2+theta)), (0.25*(1-theta)), (0.25*(1-theta)), (0.25*theta) ))
return(sum)
}
theta_opt <- optimize(lik, c(0, 1), maximum = TRUE)
mle_theta <- theta_opt$maximum
mle_theta
expected <- sum(x_i) * c( (0.25*(2+mle_theta)), (0.25*(1-mle_theta)), (0.25*(1-mle_theta)), (0.25*mle_theta) )
rejection <- 2 * sum(x_i * log(x_i/expected))
rejection
pval <- 1 - pchisq(q=rejection, df = 2)
pval
# pval is greater than 0.05, failing to reject the fit.
suicide <- matrix(c(3755, 3251, 3777, 3706, 3717, 3660, 3669, 3626, 3481, 3590, 3605, 3392, 1362, 1244, 1496, 1452, 1448, 1376, 1370, 1301, 1337, 1351, 1416, 1226), nrow = 2, byrow = TRUE)
colnames(suicide) <- 1:12
rownames(suicide) <- c("male", "female")
suicide
#Null Hypothesis: no seasonality for male(uniform distribution across months)
#Alt. Hypothesis: seasonality(distribution across months are not uniform)
chisq.test(suicide[1,], correct = FALSE)
#reject the null hypothesis -> there is a seasonality for male
#Null Hypothesis: no seasonality for female(uniform distribution across months)
#Alt. Hypothesis: seasonality(distribution across months are not uniform)
chisq.test(suicide[2,], correct = FALSE)
#reject the null hypothesis -> there is a seasonality for female
employment_marital <- matrix(c(790, 98, 209, 56, 11, 27, 21, 7, 12), nrow = 3, byrow=TRUE)
colnames(employment_marital) <- c("married", "once married", "never married")
rownames(employment_marital) <- c("employed", "unemployed", "not in labor force")
employment_marital
#null hypothesis: marital status and employment status are independent
#alt. hypothesis: they are dependent
test_e_m <- chisq.test(employment_marital, correct = FALSE)
test_e_m
#df = (number of row -1) * (number of columns - 1) = 2 * 2 = 4 -> consistent with the df in R
#Since pval is less than 0.05, we fail to reject the null that they are independent at 0.05 significance level
#married men are mroe likely to be employed than others because they will be more likely to live with family to take care of.
expected_counts <- test_e_m$expected
expected_counts
#R prints out a warning message since there is a cell with less than 5 observations. In this case, expected observations for "not in labor force"" and "once married" is 3.76, which is less than 5.
pearson_estimate <- sum(((employment_marital - expected_counts)^2 )/expected_counts)
pearson_estimate
with_log <- 2 * sum(employment_marital * log(employment_marital/expected_counts))
with_log
#chisq.test uses Pearson Chi-Squared Test
total_unemployed <- sum(employment_marital[2,])
rate_unemployed <- total_unemployed / sum(employment_marital)
rate_unemployed
se <- sqrt(rate_unemployed * (1-rate_unemployed) / (sum(employment_marital) - 1))
se
lower_bound <- rate_unemployed - 1.96 * se
upper_bound <- rate_unemployed + 1.96 * se
# 95% confidence interval for the proportion of unemployed men is
lower_bound
upper_bound
rbinom
h_sample <- rbinom(n = 5, size = 1000, p = 0.4)
table(h_sample)
h_sample <- rbinom(n = 1000, size = n, p = 0.4)
table(h_sample)
h_sample <- rbinom(n = 1000, size = 5, p = 0.4)
table(h_sample)
?rbinom
h_sample
table(h_sample)[0]
table(h_sample)[1]
count_each <- table(h_sample)
count_each
mle_p <- h_sample[]
count_each
expected_prob <- c((1-mle_p)^5, 5*((1-mle_p)^4)*mle_p, 10*((1-mle_p)^3)*mle_p^2, 10*((1-mle_p)^2)*mle_p^3, 5*((1-mle_p)^1)*mle_p^4, mle_p^5)
expected_prob
mle_p
h_sample <- rbinom(n = 1000, size = 5, p = 0.4)
count_each <- table(h_sample)
count_each
mle_p <- sum(h_sample) / (1000*5)
mle_p
h_sample <- rbinom(n = 1000, size = 5, p = 0.4)
count_each <- table(h_sample)
count_each
mle_p <- sum(h_sample) / (1000*5)
mle_p
expected_prob <- c((1-mle_p)^5, 5*((1-mle_p)^4)*mle_p, 10*((1-mle_p)^3)*mle_p^2, 10*((1-mle_p)^2)*mle_p^3, 5*((1-mle_p)^1)*mle_p^4, mle_p^5)
expected_prob
chisq.test(x=count_each, p=expected_prob)
h_pval <- 1-pchisq(h_test$statistic, df = 4)
expected_prob <- c((1-mle_p)^5, 5*((1-mle_p)^4)*mle_p, 10*((1-mle_p)^3)*mle_p^2, 10*((1-mle_p)^2)*mle_p^3, 5*((1-mle_p)^1)*mle_p^4, mle_p^5)
expected_prob
h_test <- chisq.test(x=count_each, p=expected_prob)
h_test
#We have estimated 1 parameter, so the actual degree of freedom is 6 - 1 - 1 = 4 instead of 5
h_pval <- 1-pchisq(h_test$statistic, df = 4)
h_pval
?rbinom
generate <- function() {
i_sample <- rbinom(1000, 5, 0.4)
mleP <- sum(i_sample)/5000
i_obs <- table(i_sample)
i_exp <- 1000 * c((1-mleP)^5, 5*((1-mleP)^4)*mleP, 10*((1-mleP)^3)*mleP^2, 10*((1-mleP)^2)*mleP^3, 5*((1-mleP)^1)*mleP^4, mleP^5)
i_pearson <- sum(((i_obs - i_exp)^2)/i_exp)
i_chi <- 2 * sum(i_obs*log(i_obs/i_exp))
return(c(i_pearson, i_chi))
}
out <- replicate(2000, generate())
out <- t(out)
View(out)
View(out)
generate <- function() {
i_sample <- rbinom(1000, 5, 0.4)
mleP <- sum(i_sample)/5000
i_obs <- table(i_sample)
i_exp <- 1000 * c((1-mleP)^5, 5*((1-mleP)^4)*mleP, 10*((1-mleP)^3)*mleP^2, 10*((1-mleP)^2)*mleP^3, 5*((1-mleP)^1)*mleP^4, mleP^5)
i_pearson <- sum(((i_obs - i_exp)^2)/i_exp)
i_chi <- 2 * sum(i_obs*log(i_obs/i_exp))
chi_value <- c(i_pearson, i_chi)
names(chi_value) <- c("pearson", "chi")
return(chi_value)
}
out <- replicate(2000, generate())
generate <- function() {
i_sample <- rbinom(1000, 5, 0.4)
mleP <- sum(i_sample)/5000
i_obs <- table(i_sample)
i_exp <- 1000 * c((1-mleP)^5, 5*((1-mleP)^4)*mleP, 10*((1-mleP)^3)*mleP^2, 10*((1-mleP)^2)*mleP^3, 5*((1-mleP)^1)*mleP^4, mleP^5)
i_pearson <- sum(((i_obs - i_exp)^2)/i_exp)
i_chi <- 2 * sum(i_obs*log(i_obs/i_exp))
chi_value <- c(i_pearson, i_chi)
return(chi_value)
}
out <- replicate(2000, generate())
out <- t(out)
View(out)
View(out)
generate <- function() {
i_sample <- rbinom(1000, 5, 0.4)
mleP <- sum(i_sample)/5000
i_obs <- table(i_sample)
i_exp <- 1000 * c((1-mleP)^5, 5*((1-mleP)^4)*mleP, 10*((1-mleP)^3)*mleP^2, 10*((1-mleP)^2)*mleP^3, 5*((1-mleP)^1)*mleP^4, mleP^5)
i_pearson <- sum(((i_obs - i_exp)^2)/i_exp)
i_chi <- 2 * sum(i_obs*log(i_obs/i_exp))
chi_value <- c(i_pearson, i_chi)
return(chi_value)
}
out <- replicate(2000, generate())
out <- t(out)
colnames(out) <- c("Pearson", "Chi Value")
View(out)
View(out)
chis <- sapply(c(1:2000), generate)
library(ggplot2)
library(dplyr)
df <- data.frame(out)
View(df)
View(df)
generate <- function() {
i_sample <- rbinom(1000, 5, 0.4)
mleP <- sum(i_sample)/5000
i_obs <- table(i_sample)
i_exp <- 1000 * c((1-mleP)^5, 5*((1-mleP)^4)*mleP, 10*((1-mleP)^3)*mleP^2, 10*((1-mleP)^2)*mleP^3, 5*((1-mleP)^1)*mleP^4, mleP^5)
i_pearson <- sum(((i_obs - i_exp)^2)/i_exp)
i_chi <- 2 * sum(i_obs*log(i_obs/i_exp))
chi_value <- c(i_pearson, i_chi)
return(chi_value)
}
out <- replicate(2000, generate())
out <- t(out)
colnames(out) <- c("Pearson", "Chi Value")
df <- data.frame(out)
df %>% ggplot() + geom_histogram(aes(x = Chi.Value, y = ..density..), bins = 50) + stat_function(fun = dchisq, args = 4, color = "red") + labs(title = "X = -2logLamda", x = "Chi-Squared Value")
df %>% ggplot() + geom_histogram(aes(x = Pearson, y = ..density..), bins = 50) + stat_function(fun = dchisq, args = 4, color = "red") + labs(title = "Pearson Estimates", x = "Chi-Squared Value")
install.packages("testthat")
shiny::runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/demo')
?colors
colors()
return("yellow" == colors())
"yellow" == colors()
which("yellow" == colors())
which("yellowdfa" == colors())
is.integer(which("yellow" == colors()))
is.integer(which("yellowasdfa" == colors()))
(which("yellowasdfa" == colors())) > 0
(which("yellow" == colors())) > 0
is.color("yellow")
?is.color
"adf"
length("adf")
knitr::opts_chunk$set(echo = TRUE)
library(testthat)
alabama <- nchar(states[1])
head(USArrests)
states <- rownames(USArrests)
num_chars <- nchar(states)
tolower(states)
toupper(states)
casefold(states)
table(num_chars)
table(num_chars)
head(USArrests)
states <- rownames(USArrests)
num_chars <- nchar(states)
tolower(states)
toupper(states)
casefold(states)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs
num_chars
table(num_chars)
?barplot
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs <- data.frame(char_freqs)
View(char_freqs)
View(char_freqs)
knitr::opts_chunk$set(echo = TRUE)
library(testthat)
library(ggplot2)
library(dplyr)
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs <- data.frame(char_freqs)
barplot(char_freqs)
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs <- data.frame(char_freqs)
barplot(char_freqs[,2])
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs <- as.matrix(char_freqs)
barplot(char_freqs)
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs <- data.frame(char_freqs)
barplot(char_freqs[,2])
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
barplot(char_freqs)
char_freqs <- data.frame(char_freqs)
barplot(char_freqs[,2])
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
barplot(char_freqs, xlab="num_chars", ylab = "freq")
table(num_chars)
char_freqs
table(num_chars)
char_freqs <- table(num_chars)/length(num_chars)
char_freqs
barplot(char_freqs, xlab="num_chars", ylab = "freq", ylim = c(0, 0.3))
knitr::opts_chunk$set(echo = TRUE)
x_i <- c(1997, 906, 904, 32)
lik <- function(theta) {
sum <- dmultinom(x = x_i, size = sum(x_i), prob = c( (0.25*(2+theta)), (0.25*(1-theta)), (0.25*(1-theta)), (0.25*theta) ))
return(sum)
}
theta_opt <- optimize(lik, c(0, 1), maximum = TRUE)
mle_theta <- theta_opt$maximum
mle_theta
expected <- sum(x_i) * c( (0.25*(2+mle_theta)), (0.25*(1-mle_theta)), (0.25*(1-mle_theta)), (0.25*mle_theta) )
rejection <- 2 * sum(x_i * log(x_i/expected))
rejection
pval <- 1 - pchisq(q=rejection, df = 2)
pval
# pval is greater than 0.05, failing to reject the fit.
View(theta_opt)
View(theta_opt)
chisq.test(x_i, p = c( (0.25*(2+mle_theta)), (0.25*(1-mle_theta)), (0.25*(1-mle_theta)), (0.25*mle_theta) ), correct = FALSE)
install.packageo("colourpicker")
install.packages("colourpicker")
getwd()
shiny::runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
?sidebarInput
sliderInput
?sliderInput
?sidebarPanel
?selectInput
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
?hr
?column
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/workout02')
getwd
getwd()
setwd("../Desktop/Spring 2019/Stat 133/hw-stat133")
setwd("./workout02")
getwd()
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/shiny')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/shiny')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/shiny')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/shiny')
runApp('C:/Users/daese/Desktop/Spring 2019/STAT 133/hw-stat133/workout02/shiny')
